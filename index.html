<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Tahoma, Arial, sans-serif; background: #f5f5f5; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        .header h1 { font-size: 20px; margin-bottom: 5px; }
        .header p { font-size: 18px; opacity: 0.9; margin-top: 5px; }
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }
        .welcome-message { text-align: center; font-size: 14px; color: #374151; margin: 10px 0; }
        .back-btn { background: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .page { display: none; }
        .page.active { display: block; }
        .days-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .day-btn { background: white; border: 2px solid #667eea; padding: 20px; border-radius: 15px; font-size: 16px; font-weight: bold; color: #667eea; cursor: pointer; transition: all 0.3s; }
        .day-btn.current-day { background: #d1fae5; border-color: #10b981; color: #047857; }
        .day-btn:active { transform: scale(0.95); }
        .card-item { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s; margin-bottom: 15px; }
        .card-item:active { transform: scale(0.98); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .card-name { font-size: 16px; font-weight: bold; color: #667eea; }
        .card-type { font-size: 13px; font-weight: bold; color: #10b981; }
        .card-thumbnail { width: 100%; height: 150px; object-fit: cover; border-radius: 10px; margin-bottom: 10px; }
        .card-image-full { width: 100%; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .match-selector { background: white; border-radius: 10px; padding: 10px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .match-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e7eb; }
        .match-row:last-child { border-bottom: none; }
        .match-num { width: 30px; text-align: center; font-weight: bold; color: #6b7280; font-size: 14px; }
        .options-group { display: flex; gap: 6px; }
        .circle-option { width: 28px; height: 28px; border-radius: 50%; border: 3px solid #d1d5db; background: white; cursor: pointer; transition: all 0.3s; position: relative; font-size: 11px; display: flex; align-items: center; justify-content: center; color: #6b7280; }
        .circle-option:active { transform: scale(0.9); }
        .circle-option.selected { border-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 0 8px rgba(102, 126, 234, 0.5); }
        .stats-box { background: #dbeafe; border: 2px solid #93c5fd; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
        .stats-title { font-size: 13px; font-weight: bold; color: #1e40af; margin-bottom: 10px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; text-align: center; }
        .stat-num { font-size: 24px; font-weight: bold; color: #1e3a8a; }
        .stat-label { font-size: 11px; color: #6b7280; }
        .price-box { background: #fef3c7; border: 2px solid #fbbf24; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
        .price-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 13px; }
        .price-row.total { padding-top: 8px; border-top: 2px solid #fbbf24; margin-top: 8px; }
        .price-label { color: #92400e; }
        .price-value { font-weight: bold; }
        .price-final { font-size: 18px; color: #dc2626; font-weight: bold; }
        .alert-box { border-radius: 10px; padding: 12px; margin-bottom: 15px; text-align: center; font-size: 12px; font-weight: bold; }
        .alert-orange { background: #fed7aa; border: 2px solid #fb923c; color: #9a3412; }
        .alert-red { background: #fecaca; border: 2px solid #ef4444; color: #991b1b; }
        .alert-blue { background: #dbeafe; border: 2px solid #3b82f6; color: #1e40af; }
        .alert-green { background: #d1fae5; border: 2px solid #10b981; color: #047857; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 15px; padding: 18px; font-size: 16px; font-weight: bold; width: 100%; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); transition: all 0.3s; margin-bottom: 10px; }
        .btn-success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 15px; padding: 18px; font-size: 16px; font-weight: bold; width: 100%; cursor: pointer; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4); transition: all 0.3s; margin-bottom: 10px; }
        .btn-warning { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none; border-radius: 15px; padding: 18px; font-size: 16px; font-weight: bold; width: 100%; cursor: pointer; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4); transition: all 0.3s; margin-bottom: 10px; }
        .btn-danger { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; border-radius: 15px; padding: 18px; font-size: 16px; font-weight: bold; width: 100%; cursor: pointer; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4); transition: all 0.3s; margin-bottom: 10px; }
        .admin-btn { background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%); color: white; border: none; border-radius: 15px; padding: 15px; font-size: 14px; font-weight: bold; width: 100%; cursor: pointer; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4); transition: all 0.3s; margin-top: 15px; }
        .delete-btn { background: #ef4444; color: white; border: none; padding: 8px 12px; border-radius: 8px; font-size: 12px; cursor: pointer; margin-left: 10px; }
        .hidden { display: none !important; }
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 9999; }
        #loading.show { display: flex; }
        .spinner { color: white; text-align: center; }
        .spinner-icon { font-size: 48px; animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        #admin-section { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; z-index: 1000; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); max-width: 90%; }
        #admin-section.active { display: block; }
        .footer-box { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; font-size: 12px; color: #6b7280; margin-top: 20px; }
        .footer-box a { color: #667eea; text-decoration: none; display: block; margin: 10px 0; }
        .app-download-btn { background: linear-gradient(135deg, #059669 0%, #10b981 100%); }
        .upload-section { background: white; border-radius: 15px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .upload-btn { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 10px; padding: 12px; font-size: 14px; font-weight: bold; width: 100%; cursor: pointer; margin-bottom: 10px; }
        .file-input { display: none; }
        .preview-container { position: relative; margin: 15px 0; border: 2px dashed #667eea; border-radius: 10px; overflow: hidden; }
        .preview-image { width: 100%; display: block; }
        .coordinate-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: crosshair; }
        .coordinate-marker { position: absolute; width: 14px; height: 14px; background: red; border: 2px solid white; border-radius: 50%; transform: translate(-50%, -50%); font-size: 9px; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .coordinate-marker:hover { background: #dc2626; transform: translate(-50%, -50%) scale(1.2); }
        .input-group { margin-bottom: 10px; }
        .input-group label { display: block; margin-bottom: 5px; font-size: 13px; color: #374151; font-weight: bold; }
        .input-group input, .input-group select { width: 100%; padding: 8px; border: 2px solid #d1d5db; border-radius: 8px; font-size: 14px; }
        .info-box { background: #dbeafe; border: 2px solid #3b82f6; border-radius: 10px; padding: 12px; margin-bottom: 10px; font-size: 13px; color: #1e40af; }
        .step-indicator { background: #fef3c7; border: 2px solid #f59e0b; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; font-size: 14px; font-weight: bold; color: #92400e; }
        .card-final-preview { position: relative; background: white; border-radius: 10px; overflow: hidden; margin-bottom: 15px; }
        .card-final-image { width: 100%; display: block; }
        .card-stamp { 
            position: absolute; top: 20px; left: 20px; 
            background: rgba(0, 0, 0, 0.85); 
            padding: 14px 24px; 
            border-radius: 10px; 
            font-family: 'Merriweather', serif; 
            text-align: center; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); 
        }
        .card-stamp-title { 
            color: #ef4444; 
            font-size: 26px; 
            font-weight: bold; 
            margin-bottom: 0; 
        }
        .card-price { 
            position: absolute; bottom: 20px; right: 20px; 
            background: rgba(0, 0, 0, 0.85); 
            padding: 12px 20px; 
            border-radius: 10px; 
            font-family: 'Merriweather', serif; 
            text-align: center; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); 
        }
        .card-price-amount { 
            color: white; 
            font-size: 24px; 
            font-weight: bold; 
        }
        .card-customer-code { 
            position: absolute; top: 20px; right: 20px; 
            background: rgba(0, 0, 0, 0.85); 
            padding: 10px 18px; 
            border-radius: 8px; 
            font-family: 'Merriweather', Tahoma, sans-serif; 
            font-size: 18px; 
            color: white; 
            text-align: left; 
            direction: ltr; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); 
        }
        .payment-instruction {
            background: #fee2e2;
            border: 2px solid #ef4444;
            border-radius: 10px;
            padding: 12px;
            margin: 15px 0;
            text-align: center;
            font-size: 14px;
            color: #991b1b;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div id="loading"><div class="spinner"><div class="spinner-icon">â³</div><p>Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ...</p></div></div>
<div class="header">
    <h1 id="header-title">âš½ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø²Ù†Ø¯Ù‡ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÙˆØªØ¨Ø§Ù„ âš½</h1>
    <p id="header-time"></p>
</div>
<div class="container">
    <div class="welcome-message">Ø³Ù„Ø§Ù… Ø¯ÙˆØ³Øª Ø¹Ø²ÛŒØ²Ù…ØŒ Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒğŸŒ» Ù„Ø·ÙØ§ Ø±ÙˆØ²ÛŒ Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡Øª Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†â£ï¸</div>
    <div id="page-days" class="page active">
        <div class="days-grid">
            <button class="day-btn" onclick="goToCards('saturday')">Ø´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('sunday')">ÛŒÚ©Ø´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('monday')">Ø¯ÙˆØ´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('tuesday')">Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('wednesday')">Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('thursday')">Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡</button>
            <button class="day-btn" onclick="goToCards('friday')">Ø¬Ù…Ø¹Ù‡</button>
        </div>
        <button class="admin-btn" onclick="openAdminLogin()">Ù¾Ù†Ù„ Ù…Ø®ØµÙˆØµ Ù…Ø¯ÛŒØ±ÛŒØª</button>
        <button class="btn-success app-download-btn">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† ØªÙˆØªÙˆ98</button>
        <div class="footer-box">
            Ú©Ù„ÛŒÙ‡ Ø­Ù‚ÙˆÙ‚ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„ ØªÙ„Ú¯Ø±Ø§Ù…ÛŒ <a href="https://t.me/toto98playgame">@toto98playgame</a><br>
            ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ: <a href="https://t.me/toto968play">@toto968play</a>
        </div>
    </div>
    <div id="page-cards" class="page">
        <button class="back-btn" onclick="goToDays()">â† Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <div id="cards-container"></div>
    </div>
    <div id="page-matches" class="page">
        <button class="back-btn" onclick="goBackToCards()">â† Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <div class="alert-box alert-blue">
            ğŸ“¸ Ù„Ø·ÙØ§Ù‹ Ù†Ø¸Ø±Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† Ù‡Ù…ÛŒÙ† Ú©Ø§Ø±Øª Ø·Ø¨Ù‚ Ø´Ù…Ø§Ø±Ù‡ Ù‡Ø§ÛŒ Ø³Ù…Øª Ø±Ø§Ø³Øª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯
        </div>
        <img id="match-card-image" class="card-image-full">
        <div id="matches-container"></div>
        <div class="stats-box">
            <div class="stats-title">ğŸ“Š Ø¢Ù…Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§:</div>
            <div class="stats-grid">
                <div><div class="stat-num" id="s3">0</div><div class="stat-label">Ø³Ù‡â€ŒÙ†Ø¸Ø±</div></div>
                <div><div class="stat-num" id="s2">0</div><div class="stat-label">Ø¯Ùˆâ€ŒÙ†Ø¸Ø±</div></div>
                <div><div class="stat-num" id="s1">0</div><div class="stat-label">ØªÚ©â€ŒÙ†Ø¸Ø±</div></div>
            </div>
        </div>
        <div class="price-box">
            <div class="price-row"><span class="price-label">ğŸ’° Ù‚Ø¨Ù„ Ø§Ø² ØªØ®ÙÛŒÙ:</span><span class="price-value" id="pb">0</span></div>
            <div class="price-row"><span class="price-label">ğŸ ØªØ®ÙÛŒÙ:</span><span class="price-value" style="color: #dc2626;" id="pd">0</span></div>
            <div class="price-row total"><span class="price-label" style="font-weight: bold;">ğŸ’µ Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ:</span><span class="price-value price-final" id="pf">0</span></div>
        </div>
        <div class="payment-instruction">
            Ù„Ø·ÙØ§Ù‹ Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø¹Ø¯ Ø§Ø² ØªØ®ÙÛŒÙ Ø±Ø§ ÙˆØ§Ø±ÛŒØ² Ùˆ Ø³Ù¾Ø³ Ø§Ø³Ú©Ø±ÛŒÙ†â€ŒØ´Ø§Øª Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ± Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯â£ï¸
        </div>
        <div class="alert-box alert-orange" id="min-alert"></div>
        <div id="err" class="alert-box alert-red hidden">âŒ Ù…Ø¨Ù„Øº Ú©Ù…ØªØ± Ø§Ø² Ø­Ø¯Ø§Ù‚Ù„ Ø§Ø³Øª!</div>
        <div class="alert-box alert-green">
            âœ… Ù†Ø¸Ø±Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ú©Ø§Ù…Ù„ Ú©Ø±Ø¯ÛŒØ¯ØŸ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
        </div>
        <button class="btn-primary" onclick="showCardPreview()">ğŸ–¼ï¸ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¹Ù„Ø§Ù…Øªâ€ŒÙ‡Ø§ Ø±ÙˆÛŒ Ú©Ø§Ø±Øª Ø§ØµÙ„ÛŒ</button>
    </div>
    <div id="page-preview" class="page">
        <button class="back-btn" onclick="closePreview()">â† Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <div style="margin: 15px 0;">
            <input type="text" id="customer-code-input" placeholder="Ø±Ù…Ø² Ù…Ø´ØªØ±ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)" style="width: 100%; padding: 10px; border: 2px solid #3b82f6; border-radius: 10px; font-size: 14px; direction: rtl; text-align: right;">
        </div>
        <div class="alert-box alert-blue">
            âš ï¸ Ù„Ø·ÙØ§Ù‹ Ø¯Ø± ØµÙˆØ±Øª ØªÙ…Ø§ÛŒÙ„ Ø¬Ù‡Øª Ù†ÙˆØ´ØªÙ† Ø±Ù…Ø² Ù…Ø´ØªØ±ÛŒ Ø§Ø² Ú©Ø§Ø¯Ø± Ø¨Ø§Ù„Ø§ Ø§Ù‚Ø¯Ø§Ù…â€Œ Ú©Ø±Ø¯Ù‡ Ùˆ Ø³Ù¾Ø³ Ø¯Ú©Ù…Ù‡ Ù…ÙÙ‡Ø± Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯âœ…ï¸
        </div>
        <div id="final-card-container" class="card-final-preview">
            <img id="preview-final-image" class="card-final-image">
            <canvas id="marks-canvas" style="position: absolute; top: 0; left: 0;"></canvas>
            <div id="stamp-overlay" class="hidden">
                <div class="card-stamp">
                    <div class="card-stamp-title">ØªÙˆØªÙˆ98</div>
                </div>
            </div>
            <div id="customer-code-overlay" class="hidden"></div>
            <div id="price-overlay" class="hidden">
                <div class="card-price">
                    <div class="card-price-amount" id="final-price-display">0</div>
                </div>
            </div>
        </div>
        <button id="stamp-btn" class="btn-danger" onclick="applyStamp()">ğŸ›¡ï¸ Ù…Ù‡Ø± ØªÙˆØªÙˆ98</button>
        <button id="price-btn" class="btn-warning hidden" onclick="applyPrice()">ğŸ’° Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ</button>
        <div id="confirm-section" class="hidden">
            <div class="alert-box alert-green">
                Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ù†Ø¸Ø±Ø§Øª Ù…ÙˆØ±Ø¯ ØªØ£ÛŒÛŒØ¯ Ø´Ù…Ø§ Ø¨ÙˆØ¯ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ Ú©Ù„ÛŒÚ© Ùˆ Ø­ØªÙ…Ø§Ù‹ Ú©Ø§Ø±Øª Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯ØŒ ğŸš«ØªÙˆØ¬Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Øª Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø°Ù Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯ğŸš« Ø³Ù¾Ø³ Ú©Ø§Ø±Øª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯Ù‡ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ± Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯.
            </div>
            <button class="btn-warning" onclick="goBackToEdit()">ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø¬Ø¯Ø¯ Ù†Ø¸Ø±Ø§Øª</button>
            <button class="btn-success telegram-btn" onclick="sendToTelegram()">Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ù…Ø¯ÛŒØ± Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù…</button>
        </div>
    </div>
    <div id="upload-form" class="page">
        <button class="back-btn" onclick="closeUploadForm()">â† Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <div class="upload-section">
            <h3 style="color: #667eea; margin-bottom: 15px; text-align: center;">Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯</h3>
            <div id="upload-step-1">
                <div class="step-indicator">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ø±Øª Ø§Ø² Ù„ÛŒØ³Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶</div>
                <div class="input-group">
                    <label>Ø±ÙˆØ² Ù‡ÙØªÙ‡:</label>
                    <select id="upload-day" onchange="updateCardList()">
                        <option value="saturday">Ø´Ù†Ø¨Ù‡</option>
                        <option value="sunday">ÛŒÚ©Ø´Ù†Ø¨Ù‡</option>
                        <option value="monday">Ø¯ÙˆØ´Ù†Ø¨Ù‡</option>
                        <option value="tuesday">Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡</option>
                        <option value="wednesday">Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡</option>
                        <option value="thursday">Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡</option>
                        <option value="friday">Ø¬Ù…Ø¹Ù‡</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Ù†Ø§Ù… Ú©Ø§Ø±Øª:</label>
                    <select id="upload-name"></select>
                </div>
                <div class="info-box" id="card-info"></div>
                <button class="upload-btn" onclick="goToStep2()">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯: Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ± â†’</button>
            </div>
            <div id="upload-step-2" style="display: none;">
                <div class="step-indicator">Ù…Ø±Ø­Ù„Ù‡ Û²: Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ± Ú©Ø§Ø±Øª</div>
                <input type="file" id="card-file-input" class="file-input" accept="image/*" onchange="handleFileSelect(event)">
                <button class="upload-btn" onclick="document.getElementById('card-file-input').click()">ğŸ“ Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ± Ø§Ø² Ú¯Ø§Ù„Ø±ÛŒ</button>
                <div id="image-preview" class="preview-container" style="display: none;">
                    <img id="preview-img" class="preview-image">
                </div>
                <button id="go-to-step-3" class="upload-btn" onclick="goToStep3()" style="display: none;">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯: ØªÙ†Ø¸ÛŒÙ… Ù…Ø®ØªØµØ§Øª â†’</button>
            </div>
            <div id="upload-step-3" style="display: none;">
                <div class="step-indicator" id="coordinate-instruction">Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</div>
                <div class="info-box">
                    ğŸ“ Ú©Ù„ÛŒÚ© Û±: Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡<br>
                    ğŸ“ Ú©Ù„ÛŒÚ© Û²: Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ø±Ø§Ø³Øª Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡<br>
                    ğŸ“ Ú©Ù„ÛŒÚ© Û³: Ú¯ÙˆØ´Ù‡ Ù¾Ø§ÛŒÛŒÙ†-Ú†Ù¾ Ø¢Ø®Ø±ÛŒÙ† Ø®Ø§Ù†Ù‡<br>
                    ğŸ“ Ú©Ù„ÛŒÚ© Û´: Ú¯ÙˆØ´Ù‡ Ù¾Ø§ÛŒÛŒÙ†-Ø±Ø§Ø³Øª Ø¢Ø®Ø±ÛŒÙ† Ø®Ø§Ù†Ù‡<br><br>
                    ğŸ’¡ Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù Ù‡Ø± Ù†Ù‚Ø·Ù‡ØŒ Ø±ÙˆÛŒ Ø¢Ù† Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
                </div>
                <div class="preview-container">
                    <img id="coordinate-img" class="preview-image">
                    <div id="coordinate-overlay" class="coordinate-overlay" onclick="handleCoordinateClick(event)"></div>
                </div>
                <button id="save-card-btn" class="upload-btn" onclick="saveNewCard()" style="display: none;">âœ… Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Øª</button>
                <button class="upload-btn" onclick="resetCoordinates()" style="background: #ef4444;">ğŸ”„ Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡</button>
            </div>
        </div>
    </div>
    <div id="admin-section">
        <h2 style="text-align: center; color: #667eea; margin-bottom: 15px;">ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±</h2>
        <div id="admin-message" style="text-align: center; color: #dc2626; margin-bottom: 10px;"></div>
        <input type="password" id="admin-code" placeholder="Ú©Ø¯ Ù…Ø¯ÛŒØ±" style="width: 100%; padding: 8px; border: 2px solid #667eea; border-radius: 8px; margin-bottom: 10px;">
        <button onclick="adminLogin()" style="width: 100%; padding: 10px; background: #10b981; color: white; border: none; border-radius: 10px; font-weight: bold;">ÙˆØ±ÙˆØ¯</button>
        <button onclick="closeAdmin()" style="width: 100%; padding: 10px; background: #6b7280; color: white; border: none; border-radius: 10px; margin-top: 10px;">Ø¨Ø³ØªÙ†</button>
    </div>
    <div id="admin-panel" class="page hidden">
        <h2 style="text-align: center; color: #667eea; margin-bottom: 15px;">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
        <button class="upload-btn" onclick="showUploadForm()">â• Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯</button>
        <div id="admin-days" class="days-grid"></div>
        <div id="admin-cards"></div>
        <button class="back-btn" onclick="closeAdminPanel()">â† Ø®Ø±ÙˆØ¬</button>
    </div>
</div>
<script>
let currentDay = '', currentCard = null, selections = [];
let uploadedImage = null;
let coordinatePoints = [];
let allCoordinates = [];
let stampApplied = false, priceApplied = false;

const dayNames = { 
    saturday: 'Ø´Ù†Ø¨Ù‡', sunday: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', monday: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 
    tuesday: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', wednesday: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', thursday: 'Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡', friday: 'Ø¬Ù…Ø¹Ù‡' 
};

const FIXED_CARDS = {
    saturday: [
        { name: "Ù…Ø¯Ø§Ù„", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ú©Ø§Ú©Ø§", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 },
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û±Û°Û°Û°", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ú©ÛŒØ§Ù†", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ø±ÙˆÙ…Ø§Ù†ÛŒ", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û±Û±", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "ØªØ§ØªÙ†Ù‡Ø§Ù…", games: 17, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û±", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 },
        { name: "Ø§ÛŒØªØ§Ù„ÛŒØ§", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 }
    ],
    sunday: [
        { name: "Ø´Ø¨Ù‡Ø§ÛŒ ÙÙˆØªØ¨Ø§Ù„ÛŒ", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 15000 },
        { name: "Ù…ÛŒÙ„Ø§Ù†", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 },
        { name: "Ø´Ø§Ù‡ÛŒÙ†", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ø¢Ú˜Ø§Ú©Ø³", games: 17, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ù…Ø§ØªØ§Ø¯ÙˆØ±", games: 15, price: 100, unit: "toman", min: 100000 },
        { name: "Ù¾Ø§Ø±ÛŒØ³", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 40000 },
        { name: "Ø¢ØªØ§Ù„Ø§Ù†ØªØ§", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ø§Ø³Ù¾Ø§Ù†ÛŒØ§", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 50000 },
        { name: "Ø³ØªØ§Ø±Ú¯Ø§Ù†", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 35000 }
    ],
    monday: [
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û±Û²Û°", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 70000 },
        { name: "ÙØ±Ø§Ù†Ø³Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ù…Ø¯Ø±Ù†", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ø³Ø±ÛŒ Ø¢", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ù†Ø§Ù¾ÙˆÙ„ÛŒ", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ø§Ø±ÙˆÙ¾Ø§", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 }
    ],
    tuesday: [
        { name: "Ù†Ø§ÛŒÚ©", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 50000 },
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û±Û°Û°Û° Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ú©Ø§Ú©Ø§ Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 },
        { name: "ØªØ§ØªÙ†Ù‡Ø§Ù… Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 17, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ú©ÛŒØ§Ù† Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ø¬Ø§Ù… Ø¯Ø± Ø¬Ø§Ù… Ø·Ù„Ø§ÛŒÛŒ", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 20000 },
        { name: "Ù…Ø¯Ø§Ù„ Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ø§ÛŒØªØ§Ù„ÛŒØ§ Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ù„Ø§Ù„ÛŒÚ¯Ø§", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "ÙÙˆØªØ¨Ø§Ù„ Û± Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 }
    ],
    wednesday: [
        { name: "ÙÙˆØªØ¨Ø§Ù„Û±Û±", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ø´Ø¨Ù‡Ø§ÛŒ ÙÙˆØªØ¨Ø§Ù„ÛŒ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 15000 },
        { name: "Ø´Ø§Ù‡ÛŒÙ† Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ø¢Ú˜Ø§Ú©Ø³ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 17, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 50000 },
        { name: "Ø¢ØªØ§Ù„Ø§Ù†ØªØ§ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ù…Ø§ØªØ§Ø¯ÙˆØ± Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 15, price: 100, unit: "toman", min: 100000 },
        { name: "Ù¾Ø§Ø±ÛŒØ³ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 40000 },
        { name: "Ø³ØªØ§Ø±Ú¯Ø§Ù† Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 35000 }
    ],
    thursday: [
        { name: "ÙÙˆØªØ¨Ø§Ù„ 120", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 70000 },
        { name: "Ø³Ø±ÛŒ Ø¢ Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ù…Ø¯Ø±Ù† Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "ÙØ±Ø§Ù†Ø³Ù‡ Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 10000 },
        { name: "Ø§Ø±ÙˆÙ¾Ø§ Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 },
        { name: "Ù†Ø§Ù¾ÙˆÙ„ÛŒ Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 }
    ],
    friday: [
        { name: "Ù…ÛŒÙ„Ø§Ù† Ø¬Ù…Ø¹Ù‡", games: 17, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 20000 },
        { name: "Ù†Ø§ÛŒÚ© Ø¬Ù…Ø¹Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 50000 },
        { name: "Ù„Ø§Ù„ÛŒÚ¯Ø§ Ø¬Ù…Ø¹Ù‡", games: 18, price: 1, unit: "ØªÙˆÙ…Ø§Ù†", min: 15000 },
        { name: "Ø¬Ø§Ù… Ø¯Ø± Ø¬Ø§Ù… Ø·Ù„Ø§ÛŒÛŒ Ø¬Ù…Ø¹Ù‡", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 20000 },
        { name: "Ù¾Ù†Ú¯ÙˆØ¦Ù†", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 20000 },
        { name: "Ø¬Ø§Ù… Ø¯Ø± Ø¬Ø§Ù…", games: 18, price: 5, unit: "Ø±ÛŒØ§Ù„", min: 10000 }
    ]
};

// === ØªÙˆØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ===
function getCardInstanceKey(day, cardName) { 
    return `card_instance_${day}_${cardName}`; 
}

function saveCardInstance(day, cardName, imageData) { 
    const card = FIXED_CARDS[day].find(c => c.name === cardName);
    if (!card) return;
    const instance = {
        ...card,
        day: day,
        image: imageData,
        uploadDate: new Date().toISOString(),
        coordinates: allCoordinates,
        cornerPoints: coordinatePoints
    };
    localStorage.setItem(getCardInstanceKey(day, cardName), JSON.stringify(instance));
}

function loadCardInstance(day, cardName) { 
    const d = localStorage.getItem(getCardInstanceKey(day, cardName)); 
    return d ? JSON.parse(d) : null; 
}

function deleteCardInstance(day, cardName) { 
    localStorage.removeItem(getCardInstanceKey(day, cardName)); 
}

function getAllCardInstances() {
    const cards = {};
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('card_instance_')) {
            const data = JSON.parse(localStorage.getItem(key));
            if (!cards[data.day]) cards[data.day] = [];
            cards[data.day].push(data);
        }
    }
    return cards;
}

function goToDays() {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-days').classList.add('active');
    document.getElementById('header-title').textContent = 'âš½ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø²Ù†Ø¯Ù‡ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÙˆØªØ¨Ø§Ù„ âš½';
}

function goBackToCards() {
    document.getElementById('page-matches').classList.remove('active');
    document.getElementById('page-preview').classList.remove('active');
    document.getElementById('page-cards').classList.add('active');
}

function goToCards(day) {
    currentDay = day;
    document.getElementById('header-title').textContent = 'Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ² ' + dayNames[day];
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-cards').classList.add('active');
    const container = document.getElementById('cards-container');
    container.innerHTML = '';
    const allCards = getAllCardInstances();
    const dayCards = allCards[day] || [];
    if (dayCards.length === 0) {
        container.innerHTML = '<div class="alert-box alert-orange">Ù‡Ù†ÙˆØ² Ú©Ø§Ø±ØªÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø±ÙˆØ² Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</div>';
        return;
    }
    dayCards.forEach(card => {
        const div = document.createElement('div');
        div.className = 'card-item';
        div.onclick = () => goToMatches(card);
        div.innerHTML = `
            ${card.image ? `<img src="${card.image}" class="card-thumbnail">` : ''}
            <div class="card-header">
                <div class="card-name">${card.name}</div>
                <div class="card-type">${card.games} Ø¨Ø§Ø²ÛŒ</div>
            </div>
            <div style="font-size: 12px; color: #059669; margin-top: 8px;">âœ… Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨</div>
        `;
        container.appendChild(div);
    });
}

function goToMatches(card) {
    currentCard = card;
    selections = Array(card.games).fill(0).map(() => new Set());
    if (!card.image || !card.coordinates) { 
        alert('âš ï¸ Ø§ÛŒÙ† Ú©Ø§Ø±Øª Ù†Ø§Ù‚Øµ Ø§Ø³Øª!'); 
        return; 
    }
    document.getElementById('min-alert').textContent = 'âš ï¸ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº: ' + card.min.toLocaleString('en-US') + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('match-card-image').src = card.image;
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-matches').classList.add('active');
    const container = document.getElementById('matches-container');
    container.innerHTML = '';
    for (let i = 0; i < card.games; i++) {
        const div = document.createElement('div');
        div.className = 'match-selector';
        div.innerHTML = `
            <div class="match-row">
                <div class="match-num">${i + 1}</div>
                <div class="options-group">
                    <div class="circle-option user-selection" data-m="${i}" data-o="1">1</div>
                    <div class="circle-option user-selection" data-m="${i}" data-o="X">X</div>
                    <div class="circle-option user-selection" data-m="${i}" data-o="2">2</div>
                </div>
            </div>
        `;
        container.appendChild(div);
    }
    updateCalc();
}

document.addEventListener('click', e => {
    if (e.target.classList.contains('user-selection')) {
        const m = parseInt(e.target.dataset.m), o = e.target.dataset.o;
        if (selections[m].has(o)) { 
            selections[m].delete(o); 
            e.target.classList.remove('selected'); 
        } else { 
            selections[m].add(o); 
            e.target.classList.add('selected'); 
        }
        updateCalc();
    }
});

function updateCalc() {
    let c3 = 0, c2 = 0, c1 = 0;
    selections.forEach(s => { 
        if (s.size === 3) c3++; 
        else if (s.size === 2) c2++; 
        else if (s.size === 1) c1++; 
    });
    document.getElementById('s3').textContent = c3; 
    document.getElementById('s2').textContent = c2; 
    document.getElementById('s1').textContent = c1;
    const total = Math.pow(3, c3) * Math.pow(2, c2);
    let unitPrice = currentCard.price; 
    if (currentCard.unit === 'Ø±ÛŒØ§Ù„') unitPrice = currentCard.price / 10;
    const price = total * unitPrice;
    let discountRate = currentCard.discount || 25;
    if (currentCard.name === "Ù…Ø§ØªØ§Ø¯ÙˆØ±" || currentCard.name === "Ù…Ø§ØªØ§Ø¯ÙˆØ± Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡") {
        discountRate = 20;
    }
    const dis = price * (discountRate / 100);
    const fin = price - dis;
    document.getElementById('pb').textContent = price.toLocaleString('en-US') + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('pd').textContent = dis.toLocaleString('en-US') + ' ØªÙˆÙ…Ø§Ù† (' + discountRate + '%)';
    document.getElementById('pf').textContent = fin.toLocaleString('en-US') + ' ØªÙˆÙ…Ø§Ù†';
    document.getElementById('err').classList.toggle('hidden', fin === 0 || fin >= currentCard.min);
}

function validateSelections() {
    const missing = [];
    selections.forEach((s, i) => {
        if (s.size === 0) missing.push(i + 1);
    });
    if (missing.length > 0) {
        alert(`âš ï¸ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ ${missing.join(', ')} Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯!`);
        return false;
    }
    return true;
}

function showCardPreview() {
    if (!validateSelections()) return;
    const total = Math.pow(3, selections.filter(s => s.size === 3).length) * Math.pow(2, selections.filter(s => s.size === 2).length);
    let unitPrice = currentCard.price; 
    if (currentCard.unit === 'Ø±ÛŒØ§Ù„') unitPrice = currentCard.price / 10;
    const price = total * unitPrice;
    let discountRate = currentCard.discount || 25;
    if (currentCard.name === "Ù…Ø§ØªØ§Ø¯ÙˆØ±" || currentCard.name === "Ù…Ø§ØªØ§Ø¯ÙˆØ± Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡") {
        discountRate = 20;
    }
    const fin = price - (price * (discountRate / 100));
    if (fin < currentCard.min) {
        alert('âŒ Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ Ú©Ù…ØªØ± Ø§Ø² Ø­Ø¯Ø§Ù‚Ù„ Ø§Ø³Øª!');
        return;
    }
    stampApplied = false;
    priceApplied = false;
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-preview').classList.add('active');
    const img = document.getElementById('preview-final-image');
    img.src = currentCard.image;
    document.getElementById('stamp-overlay').classList.add('hidden');
    document.getElementById('customer-code-overlay').classList.add('hidden');
    document.getElementById('price-overlay').classList.add('hidden');
    document.getElementById('stamp-btn').classList.remove('hidden');
    document.getElementById('price-btn').classList.add('hidden');
    document.getElementById('confirm-section').classList.add('hidden');
    img.onload = () => {
        drawMarksOnCard();
    };
}

function drawMarksOnCard() {
    const img = document.getElementById('preview-final-image');
    const canvas = document.getElementById('marks-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = img.naturalWidth;
    canvas.height = img.naturalHeight;
    canvas.style.width = '100%';
    canvas.style.height = 'auto';
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (!currentCard.coordinates) return;
    selections.forEach((sel, gameIndex) => {
        sel.forEach(option => {
            let coordIndex;
            if (option === '1') coordIndex = gameIndex * 3;
            else if (option === 'X') coordIndex = gameIndex * 3 + 1;
            else if (option === '2') coordIndex = gameIndex * 3 + 2;
            if (coordIndex < currentCard.coordinates.length) {
                const [x, y] = currentCard.coordinates[coordIndex];
                ctx.strokeStyle = '#ef4444';
                ctx.lineWidth = 6;
                ctx.beginPath();
                ctx.moveTo(x - 20, y - 20);
                ctx.lineTo(x + 20, y + 20);
                ctx.moveTo(x + 20, y - 20);
                ctx.lineTo(x - 20, y + 20);
                ctx.stroke();
            }
        });
    });
}

function applyStamp() {
    const customerCode = document.getElementById('customer-code-input').value.trim();
    const codeOverlay = document.getElementById('customer-code-overlay');
    if (customerCode) {
        codeOverlay.innerHTML = `<div class="card-customer-code">${customerCode}</div>`;
        codeOverlay.classList.remove('hidden');
    } else {
        codeOverlay.classList.add('hidden');
    }
    document.getElementById('stamp-overlay').classList.remove('hidden');
    stampApplied = true;
    document.getElementById('stamp-btn').classList.add('hidden');
    document.getElementById('price-btn').classList.remove('hidden');
}

function applyPrice() {
    const total = Math.pow(3, selections.filter(s => s.size === 3).length) * Math.pow(2, selections.filter(s => s.size === 2).length);
    let unitPrice = currentCard.price; 
    if (currentCard.unit === 'Ø±ÛŒØ§Ù„') unitPrice = currentCard.price / 10;
    const price = total * unitPrice;
    document.getElementById('final-price-display').textContent = price.toLocaleString('en-US');
    document.getElementById('price-overlay').classList.remove('hidden');
    priceApplied = true;
    document.getElementById('price-btn').classList.add('hidden');
    document.getElementById('confirm-section').classList.remove('hidden');
}

function closePreview() {
    document.getElementById('page-preview').classList.remove('active');
    document.getElementById('page-matches').classList.add('active');
}

function goBackToEdit() {
    closePreview();
}

function captureCard() {
    return new Promise((resolve, reject) => {
        const stampTitle = document.querySelector('.card-stamp-title');
        const customerCodeEl = document.querySelector('.card-customer-code');
        const originalFont = stampTitle ? (stampTitle.style.fontFamily || getComputedStyle(stampTitle).fontFamily) : '';
        const originalCodeFont = customerCodeEl ? (customerCodeEl.style.fontFamily || getComputedStyle(customerCodeEl).fontFamily) : '';
        if (stampTitle) stampTitle.style.fontFamily = "'Tahoma', 'B Nazanin', 'Arial', sans-serif";
        if (customerCodeEl) customerCodeEl.style.fontFamily = "'Tahoma', 'B Nazanin', 'Arial', sans-serif";
        const element = document.getElementById('final-card-container');
        html2canvas(element, { 
            scale: 2,
            backgroundColor: '#ffffff',
            useCORS: true,
            logging: false,
            letterRendering: true
        }).then(canvas => {
            if (stampTitle) stampTitle.style.fontFamily = originalFont;
            if (customerCodeEl) customerCodeEl.style.fontFamily = originalCodeFont;
            resolve(canvas.toDataURL('image/png'));
        }).catch(err => {
            if (stampTitle) stampTitle.style.fontFamily = originalFont;
            if (customerCodeEl) customerCodeEl.style.fontFamily = originalCodeFont;
            reject(err);
        });
    });
}

function sendToTelegram() {
    if (!stampApplied || !priceApplied) {
        alert('âš ï¸ Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ù…Ù‡Ø± Ùˆ Ù…Ø¨Ù„Øº Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯!');
        return;
    }
    document.getElementById('loading').classList.add('show');
    setTimeout(() => {
        captureCard()
            .then(imageData => {
                const link = document.createElement('a');
                link.href = imageData;
                link.download = `toto98_card_${Date.now()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                setTimeout(() => {
                    window.open('https://t.me/toto968play', '_blank');
                    // âœ… Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ø±Ù…Ø² Ù…Ø´ØªØ±ÛŒ Ùˆ Ø¹Ù„Ø§Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆÛŒ Ú©Ø§Ø±Øª
                    document.getElementById('customer-code-input').value = '';
                    // Ø±ÛŒØ³Øª selections Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ø´ÛŒØ¯Ù† Ø¹Ù„Ø§Ù…Øªâ€ŒÙ‡Ø§ Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡
                    selections = Array(currentCard.games).fill(0).map(() => new Set());
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† canvas Ø¨Ø±Ø§ÛŒ Ø®Ø§Ù… Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Øª
                    const canvas = document.getElementById('marks-canvas');
                    const ctx = canvas.getContext('2d');
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    document.getElementById('loading').classList.remove('show');
                }, 1000);
            })
            .catch(() => {
                document.getElementById('loading').classList.remove('show');
                alert('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ ØªØµÙˆÛŒØ±!');
            });
    }, 500);
}

// === Ø³Ø§ÛŒØ± ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ===
function openAdminLogin() {
    document.getElementById('admin-section').classList.add('active');
}
function adminLogin() {
    const code = document.getElementById('admin-code').value;
    if (code === '9561') {
        closeAdmin();
        openAdminPanel();
    } else {
        document.getElementById('admin-message').textContent = 'Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!';
    }
}
function closeAdmin() {
    document.getElementById('admin-section').classList.remove('active');
    document.getElementById('admin-code').value = '';
    document.getElementById('admin-message').textContent = '';
}
function openAdminPanel() {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('admin-panel').classList.remove('hidden');
    document.getElementById('admin-panel').classList.add('active');
    const daysContainer = document.getElementById('admin-days');
    daysContainer.innerHTML = '';
    Object.keys(dayNames).forEach(day => {
        const btn = document.createElement('button');
        btn.className = 'day-btn';
        btn.textContent = dayNames[day];
        btn.onclick = () => openAdminCards(day);
        daysContainer.appendChild(btn);
    });
    document.getElementById('admin-cards').innerHTML = '<div class="alert-box alert-blue">Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø±ÙˆØ² Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</div>';
}
function openAdminCards(day) {
    currentDay = day;
    const cardsContainer = document.getElementById('admin-cards');
    cardsContainer.innerHTML = '';
    const allCards = getAllCardInstances();
    const dayCards = allCards[day] || [];
    if (dayCards.length === 0) {
        cardsContainer.innerHTML = '<div class="alert-box alert-orange">Ù‡Ù†ÙˆØ² Ú©Ø§Ø±ØªÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø±ÙˆØ² Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</div>';
        return;
    }
    dayCards.forEach(card => {
        const div = document.createElement('div');
        div.className = 'card-item';
        div.innerHTML = `
            ${card.image ? `<img src="${card.image}" class="card-thumbnail">` : ''}
            <div class="card-header">
                <div class="card-name">${card.name}</div>
                <div class="card-type">${card.games} Ø¨Ø§Ø²ÛŒ</div>
            </div>
            <button class="delete-btn" onclick="deleteCard('${day}', '${card.name}')">Ø­Ø°Ù</button>
        `;
        cardsContainer.appendChild(div);
    });
}
function deleteCard(day, cardName) {
    if (confirm(`Ø­Ø°Ù Ú©Ø§Ø±Øª "${cardName}"ØŸ`)) {
        deleteCardInstance(day, cardName);
        alert('âœ… Ø­Ø°Ù Ø´Ø¯.');
        openAdminCards(day);
    }
}
function closeAdminPanel() {
    document.getElementById('admin-panel').classList.remove('active');
    document.getElementById('admin-panel').classList.add('hidden');
    goToDays();
}
function showUploadForm() {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('upload-form').classList.add('active');
    document.getElementById('upload-step-1').style.display = 'block';
    document.getElementById('upload-step-2').style.display = 'none';
    document.getElementById('upload-step-3').style.display = 'none';
    updateCardList();
}
function closeUploadForm() {
    document.getElementById('upload-form').classList.remove('active');
    document.getElementById('admin-panel').classList.add('active');
}
function updateCardList() {
    const day = document.getElementById('upload-day').value;
    const select = document.getElementById('upload-name');
    select.innerHTML = '';
    FIXED_CARDS[day].forEach(card => {
        const opt = document.createElement('option');
        opt.value = card.name;
        opt.textContent = card.name;
        select.appendChild(opt);
    });
    updateCardInfo();
}
function updateCardInfo() {
    const day = document.getElementById('upload-day').value;
    const name = document.getElementById('upload-name').value;
    const card = FIXED_CARDS[day].find(c => c.name === name);
    if (card) {
        document.getElementById('card-info').innerHTML = `
            ğŸ”¹ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§: ${card.games}<br>
            ğŸ”¹ Ù‚ÛŒÙ…Øª Ù‡Ø± Ø±Ø¯ÛŒÙ: ${card.price} ${card.unit}<br>
            ğŸ”¹ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº: ${card.min.toLocaleString('en-US')} ØªÙˆÙ…Ø§Ù†<br>
            ğŸ”¹ ØªØ®ÙÛŒÙ Ù¾ÛŒØ´â€ŒÙØ±Ø¶: 25%<br>
        `;
    }
}
document.getElementById('upload-name').addEventListener('change', updateCardInfo);
function goToStep2() {
    const name = document.getElementById('upload-name').value.trim();
    if (!name) {
        alert('âš ï¸ Ù†Ø§Ù… Ú©Ø§Ø±Øª Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
        return;
    }
    document.getElementById('upload-step-1').style.display = 'none';
    document.getElementById('upload-step-2').style.display = 'block';
}
function handleFileSelect(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
        uploadedImage = e.target.result;
        document.getElementById('preview-img').src = uploadedImage;
        document.getElementById('image-preview').style.display = 'block';
        document.getElementById('go-to-step-3').style.display = 'block';
    };
    reader.readAsDataURL(file);
}
function goToStep3() {
    if (!uploadedImage) {
        alert('âš ï¸ Ø§Ø¨ØªØ¯Ø§ ØªØµÙˆÛŒØ± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
        return;
    }
    document.getElementById('upload-step-2').style.display = 'none';
    document.getElementById('upload-step-3').style.display = 'block';
    document.getElementById('coordinate-img').src = uploadedImage;
    coordinatePoints = [];
    allCoordinates = [];
    document.getElementById('coordinate-overlay').innerHTML = '';
    document.getElementById('coordinate-instruction').textContent = 'Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯';
}
function handleCoordinateClick(event) {
    if (event.target.classList.contains('coordinate-marker')) {
        const index = parseInt(event.target.dataset.index);
        coordinatePoints.splice(index, 1);
        updateCoordinateMarkers();
        return;
    }
    if (coordinatePoints.length >= 4) {
        alert('âš ï¸ Û´ Ù†Ù‚Ø·Ù‡ Ø«Ø¨Øª Ø´Ø¯Ù‡. Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù Ø±ÙˆÛŒ Ù‡Ø± Ù†Ù‚Ø·Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.');
        return;
    }
    const rect = event.currentTarget.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;
    const img = document.getElementById('coordinate-img');
    const scaleX = img.naturalWidth / img.width;
    const scaleY = img.naturalHeight / img.height;
    coordinatePoints.push([x * scaleX, y * scaleY]);
    updateCoordinateMarkers();
}
function updateCoordinateMarkers() {
    const overlay = document.getElementById('coordinate-overlay');
    const img = document.getElementById('coordinate-img');
    const scaleX = img.naturalWidth / img.width;
    const scaleY = img.naturalHeight / img.height;
    overlay.innerHTML = '';
    coordinatePoints.forEach((point, index) => {
        const marker = document.createElement('div');
        marker.className = 'coordinate-marker';
        marker.style.left = (point[0] / scaleX) + 'px';
        marker.style.top = (point[1] / scaleY) + 'px';
        marker.textContent = index + 1;
        marker.dataset.index = index;
        overlay.appendChild(marker);
    });
    const instructions = [
        'Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ø±Ø§Ø³Øª Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯',
        'Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ù¾Ø§ÛŒÛŒÙ†-Ú†Ù¾ Ø¢Ø®Ø±ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯',
        'Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ù¾Ø§ÛŒÛŒÙ†-Ø±Ø§Ø³Øª Ø¢Ø®Ø±ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯',
        'âœ… ØªÙ…Ø§Ù… Ù†Ù‚Ø§Ø· Ø«Ø¨Øª Ø´Ø¯!'
    ];
    if (coordinatePoints.length > 0 && coordinatePoints.length <= 4) {
        document.getElementById('coordinate-instruction').textContent = instructions[coordinatePoints.length - 1];
    }
    if (coordinatePoints.length === 4) {
        calculateAllCoordinates();
        document.getElementById('save-card-btn').style.display = 'block';
    } else {
        document.getElementById('save-card-btn').style.display = 'none';
    }
}
function resetCoordinates() {
    coordinatePoints = [];
    allCoordinates = [];
    document.getElementById('coordinate-overlay').innerHTML = '';
    document.getElementById('coordinate-instruction').textContent = 'Ù„Ø·ÙØ§Ù‹ Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ø§ÙˆÙ„ÛŒÙ† Ø®Ø§Ù†Ù‡ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯';
    document.getElementById('save-card-btn').style.display = 'none';
}
function calculateAllCoordinates() {
    const day = document.getElementById('upload-day').value;
    const name = document.getElementById('upload-name').value;
    const card = FIXED_CARDS[day].find(c => c.name === name);
    if (!card) return;
    const games = card.games;
    const [topLeft, topRight, bottomLeft, bottomRight] = coordinatePoints;
    allCoordinates = [];
    for (let row = 0; row < games; row++) {
        const rowProgress = row / Math.max(1, games - 1);
        const leftX = topLeft[0] + (bottomLeft[0] - topLeft[0]) * rowProgress;
        const leftY = topLeft[1] + (bottomLeft[1] - topLeft[1]) * rowProgress;
        const rightX = topRight[0] + (bottomRight[0] - topRight[0]) * rowProgress;
        const rightY = topRight[1] + (bottomRight[1] - topRight[1]) * rowProgress;
        for (let col = 0; col < 3; col++) {
            const colProgress = col / 2;
            const x = leftX + (rightX - leftX) * colProgress;
            const y = leftY + (rightY - leftY) * colProgress;
            allCoordinates.push([Math.round(x), Math.round(y)]);
        }
    }
}
function saveNewCard() {
    const name = document.getElementById('upload-name').value.trim();
    const day = document.getElementById('upload-day').value;
    if (!name || !uploadedImage || coordinatePoints.length !== 4) {
        alert('âš ï¸ ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„ Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯.');
        return;
    }
    const card = FIXED_CARDS[day].find(c => c.name === name);
    if (!card) return;
    const fullCardData = {
        ...card,
        coordinates: allCoordinates,
        cornerPoints: coordinatePoints,
        day: day,
        image: uploadedImage,
        uploadDate: new Date().toISOString(),
        discount: 25
    };
    localStorage.setItem(getCardInstanceKey(day, name), JSON.stringify(fullCardData));
    alert(`âœ… Ú©Ø§Ø±Øª "${name}" Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯!`);
    closeUploadForm();
    openAdminCards(day);
}
function autoDeleteOldCards() {
    const now = new Date();
    const currentHour = now.getHours();
    if (currentHour === 12) {
        const dayIndex = now.getDay();
        const dayNamesList = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
        const yesterday = dayNamesList[(dayIndex + 6) % 7];
        const allCards = getAllCardInstances();
        const yesterdayCards = allCards[yesterday] || [];
        yesterdayCards.forEach(card => {
            deleteCardInstance(yesterday, card.name);
        });
        console.log(`âœ… Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ² ${yesterday} Ø­Ø°Ù Ø´Ø¯Ù†Ø¯.`);
    }
}
setInterval(autoDeleteOldCards, 3600000);
function updateTime() {
    const now = new Date();
    const persianDate = new Intl.DateTimeFormat('fa-IR-u-ca-persian', { 
        day: 'numeric', month: 'long', year: 'numeric' 
    }).format(now);
    const time = new Intl.DateTimeFormat('fa-IR', { 
        hour: '2-digit', minute: '2-digit', hour12: false 
    }).format(now);
    document.getElementById('header-time').textContent = `${persianDate}ØŒ ${time}`;
    const dayNamesList = ['ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡', 'Ø´Ù†Ø¨Ù‡'];
    const today = dayNamesList[now.getDay()];
    document.querySelectorAll('.day-btn').forEach(btn => {
        btn.classList.toggle('current-day', btn.textContent === today);
    });
}
setInterval(updateTime, 1000);
updateTime();
autoDeleteOldCards();
</script>
</body>
    </html>
